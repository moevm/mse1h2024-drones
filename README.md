# mse1h2024-drones

## Итерация 1

### Подробная постановка задачи

Проект используется для демонстрации возможностей кафедры. На полигоне есть робот-тележка с прикрепленным на его спину qr кодом. Код решения предварительно скачан с github. При помощи единственной команды этот код запущен. Решение управляет полетом дрона Tello. У пользователя есть возможность отдать 4 команды: начать демонстрацию, закончить демонстрацию, посмотреть на то что видит камера дрона, аварийная остановка. Во время демонстрации дрон поднимается в воздух, направляет камеру на qr код и стремиться видеть qr код в течение всей демонстрации.

### Собранные и проанализированные требования

- (Задача минимум) Определить начальные условия, при которых работает решение.
- (Задача минимум) Дрон следит за qr кодом хотя бы как-нибудь.
- (Задача минимум) Решение работает на каком-нибудь симуляторе.
- (Уже устроит) Движение дрона управляется PID-регулятором.
- (Уже устроит) Дрон должен всегда видеть qr код, после того, как увидел его в первый раз.
- (Максимум) Решение одинаково хорошо работает как на симуляторе, так и на реальном дроне.

### Сценарий использования

1. Пользователь загружает код созданного решения.
1. Пользователь располагает робота-тележку с наклеенным на него qr кодом и дрона так, как описано в начальных условиях.
1. Пользователь запускает решение.
1. Пользователь нажимает на кнопку *начать демонстрацию*.
1. Дрон располагается в воздухе так, чтобы видеть qr код.
1. Робот-тележка начинает двигаться по полигону.
1. Дрон меняет свое положение таким образом, чтобы всегда видеть qr код.
1. Пользователь нажимает на кнопку *закончить демонстрацию*.
1. Дрон приземляется.

### Макет UI

![ui](./wiki/res/ui.png)

## Итерация 4

### Готово

- Добавлена возможность калибровки камеры.
- Работает определитель маркера.
- GUI рисует картинку с камеры, дорисовывая координатные оси в системе отсчета маркера, если маркер определился.
- Положение маркера через pid регулятор управляет полетом дрона.

### Калибровка камеры

См. [инструкцию](./wiki/calibration.md)

### Инструкции по запуску

Программа состоит из трех частей: определителя маркера, графического интерфейса и симуляции. Они должны быть запущены ровно в этом порядке. Для этого необходимо выполнить следующие шаги.

#### Установить ROS 2 Iron

Подробности описаны [по ссылке](https://docs.ros.org/en/iron/Installation/Ubuntu-Install-Debians.html).

#### Разрешить зависимости определителя и интерфейса

```
$ cd control_nodes
$ pip install -r requirements.txt
```

#### Запустить определитель маркера

В новом терминале из того же каталога.

```
$ source /opt/ros/iron/setup.bash
$ python aruco_detector.py
```

#### Запустить графический интерфейс

В новом терминале из того же каталога.

```
$ source /opt/ros/iron/setup.bash
$ python gui.py
```

#### Запустить симуляцию

См. [инструкцию](./wiki/simulation.md)

### Рекомендации по запуску

В первую очередь нажмите кнопку "Взлететь". После того, как дрон выровняется по высоте, нажмите кнопку "Начать демонстрацию". Дрон будет стараться удерживать маркер в поле зрения. Нажмите "Остановить пропеллеры", чтобы дрон перестал летать.

[Что вы увидите, если все хорошо](https://drive.google.com/file/d/19dsrGUTu2MQzVt62lNMKYS1dvTYuROUR/view?usp=sharing)

### Презентация

https://docs.google.com/presentation/d/12qdN1vGxPzlMtdegIJbwJiOCPp6F7-U3Osipv2S4q28/edit?usp=sharing